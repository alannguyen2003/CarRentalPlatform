@page
@model CarRentalPlatform.Pages.CheckOut

@{
    Layout = null;
    int subtotal = @Model.CartModel.Car.PricePerDay;

}
<!DOCTYPE html>
<html lang="en">

<!-- Mirrored from technext.github.io/frutika/checkout.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 08 Mar 2024 10:18:49 GMT -->
<!-- Added by HTTrack -->
<meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Responsive Bootstrap4 Shop Template, Created by Imran Hossain from https://imransdesign.com/">

    <!-- title -->
    <title>Check Out</title>

    <!-- favicon -->
    <link rel="shortcut icon" type="image/png" href="assets/img/favicon.png">
    <!-- google font -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Poppins:400,700&amp;display=swap" rel="stylesheet">
    <!-- fontawesome -->
    <link rel="stylesheet" href="~/css/all.min.css">
    <!-- bootstrap -->
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css">
    <!-- owl carousel -->
    <link rel="stylesheet" href="~/css/owl.carousel.css">
    <!-- magnific popup -->
    <link rel="stylesheet" href="~/css/magnific-popup.css">
    <!-- animate css -->
    <link rel="stylesheet" href="~/css/animate.css">
    <!-- mean menu css -->
    <link rel="stylesheet" href="~/css/meanmenu.min.css">
    <!-- main style -->
    <link rel="stylesheet" href="~/css/main.css">
    <!-- responsive -->
    <link rel="stylesheet" href="~/css/responsive.css">
    <!-- custom style-->
    <link rel="stylesheet" href="~/css/custom-style.css">
    <!-- Add Icon-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">



</head>
<body>

    <!--PreLoader-->
    <div class="loader">
        <div class="loader-inner">
            <div class="circle"></div>
        </div>
    </div>
    <!--PreLoader Ends-->
    <!-- Header -->
    <div class="top-header-area" id="sticker">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-3">
                    <!-- logo -->
                    <h2 class="ftco-heading-2"><a href="/Index" class="logo">Car<span>book</span></a></h2>
                    <!-- logo -->
                </div>
                <div class="col-md-9">
                    <div class="main-menu-wrap">
                        <!-- menu start -->
                        <nav class="main-menu">
                            <ul>
                                <li class="current-list-item">
                                    <a href="/Index">Home</a>
                                </li>
                                <li><a href="/about">About</a></li>
                                <li><a href="/price">Pricing</a></li>
                                <li><a href="/cars">Cars</a></li>
                                <li><a href="/contact">Contact</a></li>
                                <li>
                                    <div class="header-icons">
                                        <i class="fas fa-shopping-cart" style="color: #fff; font-size: 20px;"></i><a class="shopping-cart" href="/cart">Cart</a>
                                    </div>
                                </li>
                            </ul>
                        </nav>
                        <a class="mobile-show search-bar-icon" href="#"><i class="fas fa-search"></i></a>
                        <div class="mobile-menu"></div>
                        <!-- menu end -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End Header -->
    <!-- search area -->
    <div class="search-area">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <span class="close-btn"><i class="fas fa-window-close"></i></span>
                    <div class="search-bar">
                        <div class="search-bar-tablecell">
                            <h3>Search For:</h3>
                            <input type="text" placeholder="Keywords">
                            <button type="submit">Search <i class="fas fa-search"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- end search arewa -->
    <!-- breadcrumb-section -->
    <div class="breadcrumb-section breadcrumb-bg">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 offset-lg-2 text-center">
                    <div class="breadcrumb-text">
                        <p>Car Rental Platform</p>
                        <h1>Check Out</h1>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- end breadcrumb section -->
    <!-- Check Out Section -->
    <div class="checkout-section mt-150 mb-150">
        <div class="container">
            <div class="row">
                <div class="col-lg-8">
                    <div class="checkout-accordion-wrap">
                        <!-- Accordion starts -->
                        <div class="accordion" id="accordionExample">
                            <div class="card single-accordion">
                                <div class="card-header" id="headingOne">
                                    <h5 class="p-5">
                                        <i class="fa-solid fa-clipboard"></i> Checkout Billing
                                    </h5>
                                </div>
                                @if (!ViewData.ModelState.IsValid)
                                {
                                    <div class="alert alert-danger">
                                        @foreach (var modelState in ViewData.ModelState.Values)
                                        {
                                            foreach (var error in modelState.Errors)
                                            {
                                                <p>@error.ErrorMessage</p>
                                            }
                                        }
                                    </div>
                                }

                                <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordionExample">
                                    <div class="card-body">
                                        <div class="billing-address-form order-details-wrap">
                                            <form method="post">
                                                <!-- ID and Phone Number -->
                                                <div class="row mt-3">
                                                    <div class="form-group col-md-6">
                                                        <label for="id">Model</label>
                                                        <input type="text" class="form-control form-control-lg" id="id" value="@Model.AccountCheckBilling.Id" name="id" placeholder="ID" hidden>
                                                        <input type="text" class="form-control form-control-lg" value="@Model.CartModel.Car.Model" placeholder="Name" disabled>
                                                    </div>
                                                    <div class="form-group col-md-6">
                                                        <label for="phoneNumber">Phone Number</label>
                                                        <input type="tel" class="form-control form-control-lg" id="phoneNumber" value="@Model.AccountCheckBilling.PhoneNumber" placeholder="Phone Number" readonly>
                                                    </div>
                                                </div>

                                                <div class="row mt-3">
                                                    <!-- Start Date and End Date -->

                                                    <div class="form-group col-md-3">
                                                        <label for="startDate">Start Date</label>
                                                        <input type="date" class="form-control-lg" id="book_pick_date" name="startDate" value="@Model.StartDate.ToString("yyyy-MM-dd")">
                                                    </div>
                                                    <div class="form-group col-md-3">
                                                        <label for="endDate">End Date</label>
                                                        <input type="date" class="form-control-lg" id="drop_off_date" name="endDate" value="@Model.EndDate.ToString("yyyy-MM-dd")">
                                                    </div>
                                                    <!-- Deposit Amount-->
                                                    <div class="form-group col-md-6">
                                                        <label for="Deposit Amount">Deposit Amount</label>
                                                        <input type="hidden" name="depositAmount" id="depositAmount" value="0">
                                                        <input style="width: auto" type="text" class="form-control form-control-lg" id="total" value="0" readonly>
                                                    </div>
                                                </div>
                                                <!-- Note -->
                                                <div class="form-group mt-3">
                                                    <label for="note">Note</label>
                                                    <textarea class="form-control form-control-lg" id="note" name="note" rows="3" placeholder="Note"></textarea>
                                                </div>
                                                <div class="form-group mt-3">
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="termsAgreement" required>
                                                        <label class="form-check-label" for="termsAgreement">
                                                            I agree to the <a href="/TermsOfUse">Terms of Use</a> and <a href="/Policies">Policies</a> of the company providing services
                                                        </label>
                                                    </div>
                                                    <div class="form-check">
                                                        <input class="form-check-input" type="checkbox" id="informationCorrect" required>
                                                        <label class="form-check-label" for="informationCorrect">
                                                            I commit that the above information is correct. If there are any errors, I take full responsibility
                                                        </label>
                                                    </div>
                                                </div>
    
                                                <button type="submit" class="btn btn-primary btn-lg mt-3">Place Order</button>

                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Accordion ends -->
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="card">
                        <img class="card-img-top" src="@Model.CartModel.Car.ThumbnailImage" alt="Car Image">
                        <div class="card-body">
                            <h5 class="card-title">@Model.CartModel.Car.Model</h5>
                            <p class="card-text">@Model.CartModel.Car.Description</p>
                        </div>
                    </div>
                </div>
            </div>  
        </div>
    </div>


    <!-- End of Check Out Section -->
    <!-- copyright -->
    <div class="copyright">
        <div class="container">
            <div class="row">
                <div class="col-lg-6 col-md-12">
                    <p>Copyrights &copy; 2019 - <a href="https://imransdesign.com/">Imran Hossain</a>,  All Rights Reserved.</p>
                </div>
                <div class="col-lg-6 text-right col-md-12">
                    <div class="social-icons">
                        <ul>
                            <li><a href="#" target="_blank"><i class="fab fa-facebook-f"></i></a></li>
                            <li><a href="#" target="_blank"><i class="fab fa-twitter"></i></a></li>
                            <li><a href="#" target="_blank"><i class="fab fa-instagram"></i></a></li>
                            <li><a href="#" target="_blank"><i class="fab fa-linkedin"></i></a></li>
                            <li><a href="#" target="_blank"><i class="fab fa-dribbble"></i></a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- end copyright -->
    <script>
        function daysBetween(time1, time2) {
            const date1 = new Date(time1);
            const date2 = new Date(time2);
            const timeDiff = Math.abs(date2 - date1);
            const days = Math.ceil(timeDiff / (1000 * 60 * 60 * 24));
            return days;
        }

        function updateDepositAmount() {
            const startDateInput = document.getElementById("book_pick_date");
            const endDateInput = document.getElementById("drop_off_date");
            const startDate = new Date(startDateInput.value);
            let endDate = new Date(endDateInput.value);
            if (new Date(startDate) >= new Date(endDate)) {
                alert("End date must be after start date.");
                endDate = new Date(startDate.getTime() + (24 * 60 * 60 * 1000)); // Add 1 day
                endDateInput.value = endDate.toISOString().split('T')[0];
                return;
            }
            const days = daysBetween(startDate, endDate);
            const pricePerDay = @Model.CartModel.Car.PricePerDay;
            if (!isNaN(days) && days > 0) {
                const depositAmount = days * pricePerDay;
                const formattedDepositAmount = depositAmount.toLocaleString('vn-VN');
                document.getElementById("depositAmount").value = depositAmount;
                document.getElementById("total").value = formattedDepositAmount + ' đ';
            } else {
                document.getElementById("total").value = "0" + ' đ'; // Reset to 0 if dates are not valid
            }
        }

        function handleInputStartDate() {
            const startDateInput = document.getElementById("book_pick_date");
            const endDateInput = document.getElementById("drop_off_date");
            const startDate = new Date(startDateInput.value);

            // Set the min attribute for end date to the day after the selected start date
            const nextDay = new Date(startDate.getTime() + 24 * 60 * 60 * 1000);
            endDateInput.min = nextDay.toISOString().split('T')[0];
            updateDepositAmount();
        }

        function handleInputEndDate() {
            updateDepositAmount();
        }

        // Set the minimum start date to today and update the drop_off_date accordingly
        function setMinStartDate() {
            const today = new Date();
            const dd = String(today.getDate()).padStart(2, '0');
            const mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
            const yyyy = today.getFullYear();
            const minDate = yyyy + '-' + mm + '-' + dd;

            const startDateInput = document.getElementById("book_pick_date");
            startDateInput.min = minDate;
            if (new Date(startDateInput.value) < today) {
                startDateInput.value = minDate;
                handleInputStartDate(); // Update the value again based on the newly established date
            }
        }

        document.addEventListener("DOMContentLoaded", function () {
        setMinStartDate();

        var startDateInput = document.getElementById("book_pick_date");
        var endDateInput = document.getElementById("drop_off_date");

        startDateInput.addEventListener("change", handleInputStartDate);
        endDateInput.addEventListener("change", handleInputEndDate);

        // Update Deposit Amount
        handleInputStartDate();
        handleInputEndDate();
        });

    </script>


    <!-- jquery -->
    <script src="~/js/jquery-1.11.3.min.js"></script>
    <!-- bootstrap -->
    <script src="~/lib/bootstrap/dist/js/bootstrap.min.js"></script>
    <!-- count down -->
    <script src="~/js/jquery.countdown.js"></script>
    <!-- isotope -->
    <script src="~/js/jquery.isotope-3.0.6.min.js"></script>
    <!-- waypoints -->
    <script src="~/js/waypoints.js"></script>
    <!-- owl carousel -->
    <script src="~/js/owl.carousel.min.js"></script>
    <!-- magnific popup -->
    <script src="~/js/jquery.magnific-popup.min.js"></script>
    <!-- mean menu -->
    <script src="~/js/jquery.meanmenu.min.js"></script>
    <!-- sticker js -->
    <script src="~/js/sticker.js"></script>
    <!-- main js -->
    <script src="~/js/cart.js"></script>
    <!-- datepicker js-->
    <script src="~/lib/daterangepicker/moment.min.js"></script>
    <script src="~/lib/daterangepicker/daterangepicker.js"></script>
</body>
</html>